{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "routing-slip.v1.json",
  "title": "Routing Slip v1",
  "type": "array",
  "items": {
    "type": "object",
    "additionalProperties": true,
    "properties": {
      "id": { "type": "string" },
      "v": { "type": "string", "default": "1" },
      "status": { "type": "string", "enum": ["PENDING", "OK", "ERROR", "SKIP"] },
      "attempt": { "type": "integer", "minimum": 0 },
      "maxAttempts": { "type": "integer", "minimum": 0 },
      "nextTopic": { "type": "string" },
      "attributes": { "type": "object", "additionalProperties": { "type": "string" } },
      "startedAt": { "type": "string" },
      "endedAt": { "type": "string" },
      "error": {
        "oneOf": [
          { "type": "null" },
          {
            "type": "object",
            "properties": {
              "code": { "type": "string" },
              "message": { "type": "string" },
              "retryable": { "type": "boolean" }
            },
            "required": ["code"]
          }
        ]
      },
      "notes": { "type": "string" }
    },
    "required": ["id", "status"]
  }
}
