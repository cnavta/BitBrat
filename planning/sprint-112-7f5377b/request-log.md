# Request Log - sprint-112-7f5377b
2025-12-04T17:57:05-05:00 Prompt: "Start sprint" → Begin Sprint per Protocol S1-S3
2025-12-04T17:57:06-05:00 git checkout -b feature/sprint-112-7f5377b-reliability-fixes-pubsub-idempotency
2025-12-04T17:57:10-05:00 Created planning artifacts: sprint-manifest.yaml, implementation-plan.md, validate_deliverable.sh
2025-12-04T17:57:20-05:00 npm run build → success; npm test → success (planning validation)
2025-12-04T17:57:30-05:00 git add -A
2025-12-04T17:57:32-05:00 git commit -m "chore(sprint-112-7f5377b): add planning backlog and validation for reliability fixes (Pub/Sub idempotency, retry filters, sane defaults)"
2025-12-04T17:57:40-05:00 git push -u origin feature/sprint-112-7f5377b-reliability-fixes-pubsub-idempotency
2025-12-04T17:57:55-05:00 gh pr create --title "Sprint sprint-112-7f5377b – Reliability fixes planning (Pub/Sub idempotency, retry filters, sane defaults)" --body "Generated by LLM agent according to Sprint Protocol v2.4. Adds planning artifacts and backlog to remediate duplicate messages, introduce idempotency + dedupe, tune retry/timeouts, and improve telemetry. Services are down; this sprint is planning-only." → https://github.com/cnavta/BitBrat/pull/15
2025-12-04T18:55:10-05:00 Implemented runtime fixes: remove default publish timeout (now opt-in), add idempotencyKey attribute, add retry filter (no retry on publish_timeout; retry only transient gRPC codes), add subscriber in‑memory dedupe (TTL, max, env toggles).
2025-12-04T18:55:20-05:00 Updated env/dev/ingress-egress.yaml: PUBSUB_PUBLISH_TIMEOUT_MS=0 (disable local timeout by default).
2025-12-04T18:55:35-05:00 npm run build → success
2025-12-04T18:55:50-05:00 npm test → success (100 passed, 1 skipped)
2025-12-04T18:56:05-05:00 git add -A
2025-12-04T18:56:08-05:00 git commit -m "fix(pubsub): default publish timeout disabled; feat(bus): idempotencyKey attr + subscriber dedupe; feat(ingress): retry filter + attempt logs; chore(env): set PUBSUB_PUBLISH_TIMEOUT_MS=0 in dev"
2025-12-04T18:56:15-05:00 git push
2025-12-04T19:20:05-05:00 Implemented telemetry counters in Pub/Sub driver (publish.ok/error, dedupe.drop)
2025-12-04T19:20:20-05:00 Added tests: attributes.spec (idempotencyKey), pubsub-batching.spec (warning), subscriber-dedupe.spec (TTL drop)
2025-12-04T19:20:35-05:00 Added ops runbook: documentation/runbooks/messaging-reliability.md
2025-12-04T19:21:00-05:00 Updated sprint implementation-plan and verification-report to mark completed items
2025-12-04T19:21:10-05:00 npm run build → success; 1 failing test (extract-config.test) detected
2025-12-04T19:21:20-05:00 Fixed extract-config.test expectation for MAX_INSTANCES per architecture.yaml (1)
2025-12-04T19:21:30-05:00 npm run build → success; npm test → success (103 passed, 1 skipped)
