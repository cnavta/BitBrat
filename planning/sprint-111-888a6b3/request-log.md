# Request Log - sprint-111-888a6b3
2025-12-03T18:35:10-05:00 Prompt: "Start sprint" → Begin Sprint per Protocol S1-S3
2025-12-03T18:35:15-05:00 git checkout -b feature/sprint-111-888a6b3-single-service-deploy
2025-12-03T18:35:20-05:00 Created planning artifacts: sprint-manifest.yaml, implementation-plan.md
2025-12-03T18:35:40-05:00 Added: request-log.md, validate_deliverable.sh, verification-report.md, publication.yaml, retro.md, key-learnings.md
2025-12-03T18:36:00-05:00 git add planning/sprint-111-888a6b3
2025-12-03T18:36:02-05:00 git commit -m "chore(sprint-111-888a6b3): add planning backlog and validation for single-service deploy via brat"
2025-12-03T18:36:12-05:00 git push -u origin feature/sprint-111-888a6b3-single-service-deploy
2025-12-03T18:36:20-05:00 gh pr create --title "Sprint sprint-111-888a6b3 Deliverables – Backlog for single-service deploy via brat" --body "Generated by LLM agent according to Sprint Protocol v2.4. Adds planning artifacts and backlog for enabling single-service deploy via npm run brat." → https://github.com/cnavta/BitBrat/pull/14
2025-12-03T19:20:00-05:00 Implemented Brat CLI single-service deploy command: `deploy service <name>` and alias `deploy <name>`
2025-12-03T19:20:05-05:00 Updated help text and dry-run VPC preflight behavior (skip in dry-run)
2025-12-03T19:20:15-05:00 Updated planning implementation-plan.md backlog statuses (CLI completed, tests deferred)
2025-12-03T19:20:25-05:00 Updated sprint validate script to run: `npm run brat -- deploy service oauth-flow --env dev --project-id demo-project --region us-central1 --dry-run --allow-no-vpc`
2025-12-03T19:20:40-05:00 npm run build → success; npm test → success
2025-12-03T19:20:55-05:00 git add -A
2025-12-03T19:20:58-05:00 git commit -m "feat(brat): add single-service deploy command and dry-run path; docs(backlog): mark CLI task complete; chore(validate): exercise dry-run deploy"
2025-12-03T19:21:10-05:00 git push
2025-12-03T20:35:20-05:00 Implemented deploy flags: --image-tag and --repo; updated help text and wiring
2025-12-03T20:35:28-05:00 Updated sprint validate script to exercise new flags in dry-run
2025-12-03T20:35:40-05:00 npm run build → success
2025-12-03T20:35:50-05:00 npm test → success
2025-12-03T20:36:05-05:00 git add -A
2025-12-03T20:36:10-05:00 git commit -m "feat(brat): support --image-tag and --repo for deploy; chore(validate): exercise flags; docs: update backlog & verification"
2025-12-03T20:36:20-05:00 git push
2025-12-04T16:48:10-05:00 Implemented Pub/Sub latency improvements: publish duration telemetry, lowered default PUBSUB_BATCH_MAX_MS to 20ms with warning, defaulted PUBSUB_PUBLISH_TIMEOUT_MS to 2000ms on Cloud Run, added diagnostics logging
2025-12-04T16:48:20-05:00 Updated ingress-egress startup to log effective messaging configuration (BUS_PREFIX, MESSAGE_BUS_DRIVER, PUBSUB_*)
2025-12-04T16:48:30-05:00 npm run build → success; npm test → success (100 passed, 1 skipped)
2025-12-04T16:48:45-05:00 git add -A
2025-12-04T16:48:50-05:00 git commit -m "perf(pubsub): add publish duration telemetry; default batch window 20ms; default publish timeout 2s on Cloud Run; log settings; chore(ingress-egress): log runtime messaging config"
2025-12-04T16:49:00-05:00 git push
2025-12-04T17:40:10-05:00 Investigation: command-processor env overlay not applied on Cloud Run. Root cause: env loader filters by service.env keys from architecture.yaml; command-processor had none, so BOT_USERNAME from env/<env>/command-processor.yaml was excluded.
2025-12-04T17:41:00-05:00 Edited architecture.yaml: added env: [BOT_USERNAME] under services.command-processor to include overlay in deploys.
2025-12-04T17:41:20-05:00 Updated sprint validate script to dry-run deploy for command-processor to verify _ENV_VARS_ARG propagation.
2025-12-04T17:41:40-05:00 npm run build → success; npm test → success.